{"ast":null,"code":"import _regeneratorRuntime from\"/Users/corycatherall/Desktop/kc-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/corycatherall/Desktop/kc-clothing/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getSnapShotFromUserAuth),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(signInWithGoogle),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(signInWithEmail),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(isUserAuthenticated),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(signOut),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(signUp),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(onSignUpStart),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(onGoogleSignInStart),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(onEmailSignInStart),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(onCheckUserSession),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(onSignOutStart),_marked12=/*#__PURE__*/_regeneratorRuntime.mark(userSagas);import{takeLatest,put,all,call}from'redux-saga/effects';import UserActionTypes from'./user.types';import{auth,googleProvider,createUserProfileDocument,getCurrentUser}from'../../firebase/firebase.utils';import{signInFailure,signInSuccess,signOutSuccess,signOutFailure,signUpFailure,signUpSuccess}from'./user.actions';export function getSnapShotFromUserAuth(userAuth){var userRef,userSnapshot;return _regeneratorRuntime.wrap(function getSnapShotFromUserAuth$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(createUserProfileDocument,userAuth);case 3:userRef=_context.sent;_context.next=6;return userRef.get();case 6:userSnapshot=_context.sent;_context.next=9;return put(signInSuccess(_objectSpread({id:userSnapshot.id},userSnapshot.data())));case 9:_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);_context.next=15;return put(signInFailure(_context.t0));case 15:case\"end\":return _context.stop();}}},_marked,null,[[0,11]]);};export function signInWithGoogle(){var _yield$auth$signInWit,user;return _regeneratorRuntime.wrap(function signInWithGoogle$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return auth.signInWithPopup(googleProvider);case 3:_yield$auth$signInWit=_context2.sent;user=_yield$auth$signInWit.user;_context2.next=7;return getSnapShotFromUserAuth(user);case 7:_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);_context2.next=13;return put(signInFailure(_context2.t0));case 13:case\"end\":return _context2.stop();}}},_marked2,null,[[0,9]]);};export function signInWithEmail(_ref){var _ref$payload,email,password,_yield$auth$signInWit2,user;return _regeneratorRuntime.wrap(function signInWithEmail$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_ref$payload=_ref.payload,email=_ref$payload.email,password=_ref$payload.password;_context3.prev=1;_context3.next=4;return auth.signInWithEmailAndPassword(email,password);case 4:_yield$auth$signInWit2=_context3.sent;user=_yield$auth$signInWit2.user;_context3.next=8;return getSnapShotFromUserAuth(user);case 8:_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);_context3.next=14;return put(signInFailure(_context3.t0));case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[1,10]]);};export function isUserAuthenticated(){var userAuth;return _regeneratorRuntime.wrap(function isUserAuthenticated$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return getCurrentUser();case 3:userAuth=_context4.sent;if(userAuth){_context4.next=6;break;}return _context4.abrupt(\"return\");case 6:_context4.next=8;return getSnapShotFromUserAuth(userAuth);case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);_context4.next=14;return put(signInFailure(_context4.t0));case 14:case\"end\":return _context4.stop();}}},_marked4,null,[[0,10]]);};export function signOut(){return _regeneratorRuntime.wrap(function signOut$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return auth.signOut();case 3:_context5.next=5;return put(signOutSuccess());case 5:_context5.next=11;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);_context5.next=11;return put(signOutFailure(_context5.t0));case 11:case\"end\":return _context5.stop();}}},_marked5,null,[[0,7]]);};export function signUp(_ref2){var _ref2$payload,displayName,email,password,_yield$auth$createUse,user;return _regeneratorRuntime.wrap(function signUp$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_ref2$payload=_ref2.payload,displayName=_ref2$payload.displayName,email=_ref2$payload.email,password=_ref2$payload.password;_context6.prev=1;_context6.next=4;return auth.createUserWithEmailAndPassword(email,password);case 4:_yield$auth$createUse=_context6.sent;user=_yield$auth$createUse.user;_context6.next=8;return createUserProfileDocument(user,{displayName:displayName});case 8:_context6.next=10;return put(signUpSuccess(user));case 10:_context6.next=16;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](1);_context6.next=16;return put(signUpFailure(_context6.t0));case 16:case\"end\":return _context6.stop();}}},_marked6,null,[[1,12]]);};export function onSignUpStart(){return _regeneratorRuntime.wrap(function onSignUpStart$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeLatest(UserActionTypes.SIGN_UP_START,signUp);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function onGoogleSignInStart(){return _regeneratorRuntime.wrap(function onGoogleSignInStart$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START,signInWithGoogle);case 2:case\"end\":return _context8.stop();}}},_marked8);};export function onEmailSignInStart(){return _regeneratorRuntime.wrap(function onEmailSignInStart$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeLatest(UserActionTypes.EMAIL_SIGN_IN_START,signInWithEmail);case 2:case\"end\":return _context9.stop();}}},_marked9);};export function onCheckUserSession(){return _regeneratorRuntime.wrap(function onCheckUserSession$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeLatest(UserActionTypes.CHECK_USER_SESSION,isUserAuthenticated);case 2:case\"end\":return _context10.stop();}}},_marked10);};export function onSignOutStart(){return _regeneratorRuntime.wrap(function onSignOutStart$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return takeLatest(UserActionTypes.SIGN_OUT_START,signOut);case 2:case\"end\":return _context11.stop();}}},_marked11);};export function userSagas(){return _regeneratorRuntime.wrap(function userSagas$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return all([call(onGoogleSignInStart),call(onEmailSignInStart),call(isUserAuthenticated),call(onSignOutStart),call(onSignUpStart)]);case 2:case\"end\":return _context12.stop();}}},_marked12);};","map":{"version":3,"sources":["/Users/corycatherall/Desktop/kc-clothing/client/src/redux/user/user.sagas.js"],"names":["getSnapShotFromUserAuth","signInWithGoogle","signInWithEmail","isUserAuthenticated","signOut","signUp","onSignUpStart","onGoogleSignInStart","onEmailSignInStart","onCheckUserSession","onSignOutStart","userSagas","takeLatest","put","all","call","UserActionTypes","auth","googleProvider","createUserProfileDocument","getCurrentUser","signInFailure","signInSuccess","signOutSuccess","signOutFailure","signUpFailure","signUpSuccess","userAuth","userRef","get","userSnapshot","id","data","signInWithPopup","user","payload","email","password","signInWithEmailAndPassword","displayName","createUserWithEmailAndPassword","SIGN_UP_START","GOOGLE_SIGN_IN_START","EMAIL_SIGN_IN_START","CHECK_USER_SESSION","SIGN_OUT_START"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from 'redux-saga/effects';\n\nimport UserActionTypes from './user.types';\n\nimport { auth, googleProvider, createUserProfileDocument, getCurrentUser } from '../../firebase/firebase.utils'\nimport { signInFailure, signInSuccess, signOutSuccess, signOutFailure, signUpFailure, signUpSuccess } from './user.actions';\n\nexport function* getSnapShotFromUserAuth(userAuth) {\n    try{\n        const userRef = yield call(createUserProfileDocument, userAuth);\n        const userSnapshot = yield userRef.get();\n        yield put(signInSuccess({id: userSnapshot.id, ...userSnapshot.data() }))\n    } catch(error){\n       yield put(signInFailure(error))\n    }\n};\n\nexport function* signInWithGoogle(){\n    try{\n        // destructuring user off of the auth object\n        const { user } = yield auth.signInWithPopup(googleProvider);\n        yield getSnapShotFromUserAuth(user)\n    } catch(error){\n        yield put(signInFailure(error))\n    }\n};\n\nexport function* signInWithEmail({ payload: {email, password}}){\n    try{\n        const { user } = yield auth.signInWithEmailAndPassword(email, password)\n       yield getSnapShotFromUserAuth(user)\n    } catch(error){\n        yield put(signInFailure(error))\n    }\n};\n\nexport function* isUserAuthenticated(){\n    try{\n        const userAuth = yield getCurrentUser();\n        if (!userAuth) return;\n        yield getSnapShotFromUserAuth(userAuth)\n    } catch(error) {\n        yield put(signInFailure(error))\n    }\n};\n\nexport function* signOut(){\n    try{\n       yield auth.signOut()\n       yield put(signOutSuccess())\n    }catch(error){\n        yield put(signOutFailure(error))\n    }\n};\n\nexport function* signUp({payload:{displayName, email, password}}){\n    try{\n        const { user } = yield auth.createUserWithEmailAndPassword(email, password);\n        yield createUserProfileDocument(user, {displayName})\n        yield put(signUpSuccess(user))\n    }catch(error){\n        yield put(signUpFailure(error))\n    }\n};\n\n\n\nexport function* onSignUpStart(){\n    yield takeLatest(UserActionTypes.SIGN_UP_START, signUp)\n}\n\nexport function* onGoogleSignInStart() {\n    yield takeLatest(UserActionTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\n};\n\nexport function* onEmailSignInStart(){\n    yield takeLatest(UserActionTypes.EMAIL_SIGN_IN_START, signInWithEmail)\n};\n\nexport function* onCheckUserSession(){\n    yield takeLatest(UserActionTypes.CHECK_USER_SESSION, isUserAuthenticated )\n};\n\nexport function* onSignOutStart(){ // first param is the action.type listener, the next is which saga function to run.\n    yield takeLatest(UserActionTypes.SIGN_OUT_START, signOut)\n};\n\n\n\nexport function* userSagas() {\n    yield all([call(onGoogleSignInStart), call(onEmailSignInStart), call(isUserAuthenticated), call(onSignOutStart), call(onSignUpStart)])\n};"]},"metadata":{},"sourceType":"module"}